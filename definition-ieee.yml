# ============================================================================
# Innovation Review Configuration - LOCAL TEST
# ============================================================================

# Project metadata
project:
  name: "Digital Innovation Review"
  description: "Systematic literature review on supplier involvement in digital innovation"
  researcher: "Ilja Heitlager"
  email: "i.heitlager@tue.nl"
  institution: "TU Eindhoven"
  start_date: "2024-01-15"
  # research_question: "How do incumbent firms involve suppliers in digital innovation processes?"
  # This is some careful investigation of claude on the research goal
  research_question: |
    What mechanisms enable incumbent organizations to orchestrate external supplier 
    ecosystems for strategic advantage in pursuing digital innovation initiatives, 
    and how do boundary-spanning coordination capabilities affect the depth, pace, 
    and sustainability of digital transformation outcomes across organizational 
    and technological boundaries?
  
  research_dimensions:
    - "Incumbent firm strategies for supplier ecosystem engagement"
    - "Ecosystem orchestration and digital transformation outcomes"
    - "Boundary-spanning capabilities in multi-supplier coordination"
    - "Supplier coordination as source of competitive advantage"
    - "Risk management in supplier-led digital transformation"

# Database configuration
database:
  host: "localhost"
  port: 5432
  name: "paper_scanner"
  user: "pdfuser"
  password: "pdfpass"

# Search definition
search:
  name: "Supplier Digital Innovation Review"
  description: "Papers on supplier/vendor involvement in digital innovation and transformation"
  
  # Search string (for documentation) 
  query_definition: 
    - "(vendor* OR supplier* OR partner* OR 'service provider' OR provider*) AND ('digital innovation' OR 'digital strategy' OR 'digital transformation')" 

  # Date range
  date_range:
    from: 2015
    to: 2024
  
  # Databases searched
  databases:
    - scopus
    - web_of_science
    - ieee_xplore

# ============================================================================
# Templates
# ============================================================================
templates:
  - template: "screen_basics"
    steps:
      - step: "Metadata screening - test tri-state logic"
        description: |
          Screening logic: 
          - Listed values: hard EXCLUDE (must NOT have)
          - NOT: prefix hard EXCLUDE (must NOT have - exclude everything except this)
          - Omitted: no requirement (leave aside)
        enabled: true
        builtin.metadata_screening:
          # Hard excludes using NOT operator and direct exclusions
          exclude:
            doi_not_set: true
            language:
              # Exclude everything that is NOT English (hard exclude non-English)
              - NOT: "en"
            paper_types:
              # Exclude everything that is NOT journal_article
              - NOT: "journal_article"
            quality_tier:
              # Exclude low quality papers
              - NOT: "peer_reviewed_journal"
              - NOT: "non_peer_reviewed_article" # like arxiv"low"

      - step: "Keyword screening - exclude editorials, conceptual, theoretical"
        description: "Exclude papers based on keywords"
        builtin.keyword_screening:
          mode: "inclusion_required"  # Both gates must pass
          complete: strict # must have title/abstract/keywords

          # Alternative modes:
          # mode: "exclusion_only"    # Just filter out off-topic domains
          # mode: "soft"              # Keywords for ranking, no filtering      
          exclude:
            keywords: # these are hard rejects
              scope:
                - "sme*"
                - "family*"
              domains:
                - "medical"
                - "healthcare"
                - "patient"
                - "disease"
                - "clinical"
                - "pharmaceutical"
                - "drug"
              other:
                - "agriculture"
                - "farming"
                - "crop"
                - "education"
                - "classroom"
                - "student"
                - "military"
                - "weapon"
                - "consumer behavior"
                - "retail customer"
            study_types: # this is implicitly defined
              # Direct exclusions (hard exclude these study types)
              - "editorial"
              - "conceptual"
              - "theoretical"
              - "literature_review"
          include:
            thresholds: 
              auto_accept: 0.65      # Strong keyword match (need at least two categories)
              manual_review: 0.40    # Weak match â†’ semantic screening
              # score will be normalized over categories
            keywords:
              innovation:
                # - "digital*" # all variations
                # - "digital innovation" # capture combined words
                # - "digitiz*"
                - "digital transformation"
                - "technology adoption"
                - "digital adoption"
                - "technology integration"
                # - "platform"
                # - "ecosystem"
              organization:
                - "firm"
                - "company"
                - "organization"
                - "enterprise"
                - "incumbent"
                # - "business"
                # - "ecosystem"
                # - "network"
              collaboration:
                - "supplier*"
                - "vendor*"
                - "partner*"
                # - "service provider*"
                # - "provider*"
                # - "collaboration"
                # - "co-creat*"

  - template: "rocchio_screening"
    steps:
      - step: "Semantic screening based on research question"
        description: "Use semantic similarity to screen papers based on research question"
        builtin.rocchio_screening:
          model: "sentence-transformers/allenai-specter"

          # Use both primary question and dimensions for richer embedding
          use_research_dimensions: true
          dimension_weight: 0.3  # Weight dimensions at 30%, primary at 70%          

          rocchio_weights:
            alpha: 1.0
            beta: 0.75
            gamma: 0.15

          thresholds:
            accept: 0.85 #- 0.72 / 0.78
            reject: 0.25 #- 0.28 / 0.22

          initialize_from_keyword_screening: false

  - template: "complete_screening"
    description: "Complete screening workflow combining keyword and semantic screening"
    steps:
      - step: "Keyword screening - exclude editorials, conceptual, theoretical"
        builtin.run-template:
          template: "screen_basics"
      - step: "Semantic screening based on research question"
        builtin.run-template:
          template: "rocchio_screening"


# ============================================================================
# Actual workflow definition
# ============================================================================
# Import configuration - using local test data
steps:
  - step: Import full database from IEEE Xplore export
    description: "Import papers from local IEEE Xplore export file from 2025-12-31 "
    enabled: true
    builtin.bibtex_import:
      file_path: "data/bib/first_ieee.bib"
      source_type: "ieee_xplore"

  - step: Download pdfs
    builtin.download_pdfs:
      timeout: 30
      store_path: "output/pdf_ieee"
      sources:
        # - "unpaywall"
        - "publisher"
        # - "core"
        # - "openalex"
      output_errors: output/pdf_errors_openalex.json

  
  - step: Snowball forward references
    enabled: false
    builtin.citations:
      forward: 
        year: 2024
        paper-types:
          - "journal_article"    
        screening: "complete_screening"
        citations: 
          - "openalex"
        details:
          - manual
          - openalex
          - "crossref" 
        output_errors: output/fwd_errors.json

  - step: Export database to BibTeX format
    builtin.export:
      format: bibtex
      output_path: "./output/papers_new.bib"
      includes: only
      duplicates: false
      overwrite: true