# ============================================================================
# Innovation Review Configuration - LOCAL TEST
# ============================================================================

# Project metadata
project:
  name: "Digital Innovation Review"
  description: "Systematic literature review on supplier involvement in digital innovation"
  researcher: "Ilja Heitlager"
  email: "i.heitlager@tue.nl"
  institution: "TU Eindhoven"
  start_date: "2024-01-15"
  research_question: "How do incumbent firms involve suppliers in digital innovation processes?"

# Database configuration
database:
  host: "localhost"
  port: 5432
  name: "paper_scanner"
  user: "pdfuser"
  password: "pdfpass"

# Search definition
search:
  name: "Supplier Digital Innovation Review"
  description: "Papers on supplier/vendor involvement in digital innovation and transformation"
  
  # Search string (for documentation) 
  query_definition: 
    - "(vendor* OR supplier* OR partner* OR 'service provider' OR provider*) AND ('digital innovation' OR 'digital strategy' OR 'digital transformation')" 

  # Date range
  date_range:
    from: 2015
    to: 2024
  
  # Databases searched
  databases:
    - scopus
    - web_of_science
    - ieee_xplore

templates:
  - template: "screen_basics"
    steps:
    - step: Deduplicate papers using multiple matching methods
      builtin.deduplication:
        methods:
          - method: "doi_exact"
            priority: 1
          - method: "title_author_fuzzy"
            priority: 2
            threshold: 0.90
          - method: "title_fuzzy"
            priority: 3
            threshold: 0.95



    - step: Categorize and screen papers for quality
      builtin.categorization:
        exclude_types: true
        exclude_reviews: true

    - step: Keyword-based screening
      builtin.keyword_screening:
        # Hard exclusion keywords (if found, exclude immediately)
        exclusion_keywords:
          domains:
            - "medical"
            - "healthcare"
            - "patient"
            - "disease"
            - "clinical"
            - "pharmaceutical"
            - "drug"
          other:
            - "agriculture"
            - "farming"
            - "crop"
            - "education"
            - "classroom"
            - "student"
            - "military"
            - "weapon"
            - "consumer behavior"
            - "retail customer"
        
        # Inclusion keywords (need matches)
        inclusion_keywords:
          innovation:
            - "digital innovation"
            - "digitalization"
            - "digitization"
            - "digital transformation"
            - "technology adoption"
            - "platform"
            - "ecosystem"
          organization:
            - "firm"
            - "company"
            - "organization"
            - "enterprise"
            - "incumbent"
            - "business"
          collaboration:
            - "supplier"
            - "vendor"
            - "partner"
            - "service provider"
            - "provider"
            - "collaboration"
            - "co-creation"

    - step: Semantic screening based on research question
      builtin.semantic_screening:
        model: "all-mpnet-base-v2"
        thresholds:
          auto_include: 0.65
          manual_review: 0.50
          auto_exclude: 0.50

# Import configuration - using local test data
steps:
  - step: Import test papers
    description: "Import papers from standard eight cases"
    enabled: true
    builtin.bibtex_import:
      file_path: "data/bib_test/eight_cases.bib"
      source_type: "other"

  - step: Download pdfs
    builtin.download_pdfs:
      timeout: 30
      store_path: "output/pdf"
      sources:
        - "publisher"
      output_errors: output/pdf_import_errors.json

  - step: Calculate embeddings for semantic screening
    builtin.generate_embeddings:
      # model: "all-mpnet-base-v2"
      model: "sentence-transformers/allenai-specter"
      device: "mps"
      included_only: false

  - step: Export database to BibTeX format
    builtin.export:
      format: bibtex
      output_path: "./output/papers_test.bib"
      duplicates: false
      overwrite: true

  - step: Upload to PostgreSQL
    builtin.upload_database:
      db_username: "$DB_USER"
      db_password: "$DB_PASSWORD"
      db_host: "$DB_HOST"
      db_port: "$DB_PORT"
      db_name: "$DB_NAME"
      conflict_strategy: "update"